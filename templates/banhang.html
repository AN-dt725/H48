
<!DOCTYPE html>
<html>
<head>
    <title>Bắt đầu bán hàng</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
        function themVaoGio(item, price) {
            let ul = document.getElementById("cart");
            let li = document.createElement("li");
            li.innerHTML = item + " - " + price + " <button onclick='this.parentElement.remove(); tinhTong();'>❌ Xóa</button>";
            ul.appendChild(li);
            tinhTong();
        }

        function tinhTong() {
            let items = document.querySelectorAll("#cart li");
            let tong = 0;
            items.forEach(li => {
                let match = li.textContent.match(/(\d+)k/);
                if (match) tong += parseInt(match[1]);
            });
            document.getElementById("tong").innerText = tong + "k";
        }

        $(function() {
            $("#keyword").on("input", function() {
                let term = $(this).val();
                if (term.length > 0) {
                    $.getJSON("/autocomplete", { term: term }, function(data) {
                        $("#goiy").empty();
                        data.forEach(item => {
                            let parts = item.split(" - ");
                            $("#goiy").append(`<div><button onclick="themVaoGio('${parts[0]}', '${parts[1]}')">${item}</button></div>`);
                        });
                    });
                } else {
                    $("#goiy").empty();
                }
            });
        });
    </script>
</head>
<body>
    <a href="/"><button>🔙 Về trang chủ</button></a>
    <h2>🧺 Bắt đầu bán hàng</h2>
    <form method="POST">
        <input type="text" name="keyword" id="keyword" placeholder="Nhập tên sản phẩm..." autocomplete="off">
        <input type="submit" value="Tìm kiếm">
    </form>
    <div id="goiy"></div>

    <h3>🧺 Giỏ hàng</h3>
    <ul id="cart"></ul>
    <p>🧾 <strong>Tổng cộng: <span id="tong">0k</span></strong></p>
</body>
</html>
